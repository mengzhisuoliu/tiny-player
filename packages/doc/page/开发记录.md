# 开发记录

## 项目结构

## 规范

### git hooks

安装 git hooks 工具

```bash
pn add husky lint-staged -D -w
```

初始化 git hooks

```bash
#--no-install 参数表示强制npx使用项目中node_modules目录下的husky依赖包
npx --no-install husky install
```

注册相应的 git hooks 钩子

```sh
# 提交信息前执行
npx --no-instal husky add .husky/commit-msg "<你要执行的命令>"
# 提交前执行
npx --no-instal husky add .husky/pre-commit "<你要执行的命令>"

# 该项目的
npx --no-instal husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'
npx --no-instal husky add .husky/pre-commit 'npx --no-install lint-staged'
```

让其他人在 clone 此项目后安装依赖后自动创建 .husky 并注册 git hooks 钩子

```sh
npm set-script prepare "husky install"
```

会在 `package.json` 中添加如下脚本

```json
{
  "scripts": {
    "prepare": "husky install"
  }
}
```

### 提交规范

安装 `commitizen` 工具

```bash
pn add commitizen commitlint-config-cz  cz-customizable @commitlint/cli @commitlint/config-conventional -D -w
```

在 `package.json` 中添加脚本

```sh
npm set-script commit "cz"
```

会在 `package.json` 中添加如下脚本

```json
{
  "scripts": {
    "commit": "cz"
  }
}
```

在 `package.json` 中添加配置

```json
{
  "config": {
    "commitizen": {
      "path": "node_modules/cz-customizable"
    }
  }
}
```

创建一个 commitlint 配置文件 commitlint.config.js 到项目根目录 👇 他将继承@commitlint/config-conventional 中的 Commit message 规范。（"feat", "fix", "perf", "refactor"...）

```javascript
module.exports = { extends: ['cz'] }
```

实现自定义 commit message 规则（直接从自定义的文件里读取规则）  
[.cz-config.js](.cz-config.js) ，[默认配置.js](https://github.com/leoforfree/cz-customizable/blob/master/cz-config-EXAMPLE.js)

在终端进行测试

```sh
echo 'feat: bar' | npx --no-install commitlint
```

配置详情参考我之前的文章 [commitizen](https://juejin.cn/post/7063912026384367629#heading-7)

### 代码规范
